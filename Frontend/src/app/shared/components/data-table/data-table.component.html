<div class="table-container">
    <div class="loader-overlay" *ngIf="loading">
        <div class="spinner"></div>
    </div>
    <table class="data-table">
        <thead>
            <tr>
                <th (click)="onSort('timestamp')" class="sortable">
                    Time
                    <span class="sort-indicator" *ngIf="sortField === 'timestamp'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
                <th (click)="onSort('type')" class="sortable">
                    Type
                    <span class="sort-indicator" *ngIf="sortField === 'type'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
                <th (click)="onSort('name')" class="sortable" *ngIf="showLocationColumn">
                    Location
                    <span class="sort-indicator" *ngIf="sortField === 'name'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
                <th (click)="onSort('co2')" class="sortable">
                    CO2
                    <span class="sort-indicator" *ngIf="sortField === 'co2'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
                <th (click)="onSort('pm25')" class="sortable">
                    PM2.5
                    <span class="sort-indicator" *ngIf="sortField === 'pm25'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
                <th (click)="onSort('humidity')" class="sortable">
                    Humidity
                    <span class="sort-indicator" *ngIf="sortField === 'humidity'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
                <th>Motion</th>
                <th (click)="onSort('energy')" class="sortable">
                    Energy
                    <span class="sort-indicator" *ngIf="sortField === 'energy'">
                        {{ sortDirection === 'asc' ? '↑' : '↓' }}
                    </span>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let reading of data">
                <td>{{ formatDate(reading.timestamp) }}</td>
                <td>{{ formatType(reading.type) }}</td>
                <td *ngIf="showLocationColumn">{{ formatLocation(reading.name) }}</td>
                <td>{{ reading.co2 ?? '-' }}</td>
                <td>{{ reading.pm25 ?? '-' }}</td>
                <td>{{ reading.humidity ?? '-' }}</td>
                <td>{{ reading.motionDetected ? '✓' : '-' }}</td>
                <td>{{ reading.energy ?? '-' }}</td>
            </tr>
        </tbody>
    </table>

    <div class="pagination">
        <button class="pagination-btn" (click)="onPrev()" [disabled]="!canGoPrev">
            Previous
        </button>
        <span class="page-info">
            Page {{ currentPage }} ({{ totalCount }} total)
        </span>
        <button class="pagination-btn" (click)="onNext()" [disabled]="!canGoNext">
            Next
        </button>
    </div>
</div>